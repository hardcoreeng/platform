(self.webpackChunkprod=self.webpackChunkprod||[]).push([[527],{47715:function(e,t,n){e.exports=function(){"use strict";var e=Function.prototype.toString,t=Object.create,i=Object.defineProperty,r=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,c=Object.getPrototypeOf,a=Object.prototype,f=a.hasOwnProperty,l=a.propertyIsEnumerable,d="function"==typeof s,u="function"==typeof WeakMap,v=function(n,i){if(!n.constructor)return t(null);var r=n.constructor,o=n.__proto__||c(n);if(r===i.Object)return o===i.Object.prototype?{}:t(o);if(~e.call(r).indexOf("[native code]"))try{return new r}catch(e){}return t(o)},y=function(e,t,n,i){var r=v(e,t);for(var o in i.set(e,r),e)f.call(e,o)&&(r[o]=n(e[o],i));if(d){var c=s(e),a=c.length;if(a)for(var u=0,y=void 0;u<a;u++)y=c[u],l.call(e,y)&&(r[y]=n(e[y],i))}return r},p=function(e,t,n,c){var a=v(e,t);c.set(e,a);var f=d?o(e).concat(s(e)):o(e),l=f.length;if(l)for(var u=0,y=void 0,p=void 0;u<l;u++)if("callee"!==(y=f[u])&&"caller"!==y)if(p=r(e,y)){p.get||p.set||(p.value=n(e[y],c));try{i(a,y,p)}catch(e){a[y]=p.value}}else a[y]=n(e[y],c);return a},g=Array.isArray,m="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:void(console&&console.error&&console.error('Unable to locate global object, returning "this".'));function b(e,n){var i=!(!n||!n.isStrict),r=n&&n.realm||m,o=i?p:y,s=function(e,t){if(!e||"object"!=typeof e)return e;if(t.has(e))return t.get(e);var n,c,a,f=e.constructor;if(f===r.Object)return o(e,r,s,t);if(g(e)){if(i)return p(e,r,s,t);var l=e.length;n=new f,t.set(e,n);for(var d=0;d<l;d++)n[d]=s(e[d],t);return n}if(e instanceof r.Date)return new f(e.getTime());if(e instanceof r.RegExp)return(n=new f(e.source,e.flags||(c=e,a="",c.global&&(a+="g"),c.ignoreCase&&(a+="i"),c.multiline&&(a+="m"),c.unicode&&(a+="u"),c.sticky&&(a+="y"),a))).lastIndex=e.lastIndex,n;if(r.Map&&e instanceof r.Map)return n=new f,t.set(e,n),e.forEach((function(e,i){n.set(i,s(e,t))})),n;if(r.Set&&e instanceof r.Set)return n=new f,t.set(e,n),e.forEach((function(e){n.add(s(e,t))})),n;if(r.Blob&&e instanceof r.Blob)return e.slice(0,e.size,e.type);if(r.Buffer&&r.Buffer.isBuffer(e))return n=r.Buffer.allocUnsafe?r.Buffer.allocUnsafe(e.length):new f(e.length),t.set(e,n),e.copy(n),n;if(r.ArrayBuffer){if(r.ArrayBuffer.isView(e))return n=new f(e.buffer.slice(0)),t.set(e,n),n;if(e instanceof r.ArrayBuffer)return n=e.slice(0),t.set(e,n),n}return"function"==typeof e.then||e instanceof Error||r.WeakMap&&e instanceof r.WeakMap||r.WeakSet&&e instanceof r.WeakSet?e:o(e,r,s,t)};return s(e,function(){if(u)return new WeakMap;var e=t({has:function(t){return!!~e._keys.indexOf(t)},set:function(t,n){e._keys.push(t),e._values.push(n)},get:function(t){return e._values[e._keys.indexOf(t)]}});return e._keys=[],e._values=[],e}())}return b.default=b,b.strict=function(e,t){return b(e,{isStrict:!0,realm:t?t.realm:void 0})},b}()},6408:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l,fsmPlugin:()=>a});var i=n(41350),r=n.n(i),o=n(9479),s=n(14452),c=n(30248);const a=(0,n(98097).mergeIds)(c.default,{});var f=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{a(i.next(e))}catch(e){o(e)}}function c(e){try{a(i.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((i=i.apply(e,t||[])).next())}))};const l=()=>f(void 0,void 0,void 0,(function*(){const e=yield(0,o.getPlugin)(s.default.id),t=yield e.getClient(),n=e=>f(void 0,void 0,void 0,(function*(){return yield t.findAll(a.class.State,{fsm:e})})),i=e=>f(void 0,void 0,void 0,(function*(){return yield t.findAll(a.class.Transition,{fsm:e}).then((e=>e.filter((e=>void 0!==e))))}));return{getStates:n,getTransitions:i,addItem:(e,i,r=e._id)=>f(void 0,void 0,void 0,(function*(){var o,s;const c=yield(e=>f(void 0,void 0,void 0,(function*(){return(yield t.findAll(a.class.FSM,{_id:e.fsm}))[0]})))(e);if(void 0===c)return;const l=null!==(o=i.obj.state)&&void 0!==o?o:(yield n(c._id))[0]._id;return yield t.createDoc(null!==(s=i._class)&&void 0!==s?s:a.class.FSMItem,r,Object.assign(Object.assign({},i.obj),{fsm:e._id,state:l}))})),removeItem:(e,n)=>f(void 0,void 0,void 0,(function*(){const i=yield t.findAll(a.class.FSMItem,{item:e,fsm:n._id});yield Promise.all(i.map((e=>f(void 0,void 0,void 0,(function*(){return yield t.removeDoc(e._class,r().space.Model,e._id)})))))})),duplicateFSM:e=>f(void 0,void 0,void 0,(function*(){const o=(yield t.findAll(a.class.FSM,{_id:e}))[0];if(void 0===o)return;const s=yield i(o._id),c=yield n(o._id),l=e=>Object.entries(e).filter((([e])=>!["_id","modifiedBy","modifiedOn","createOn"].includes(e))).reduce(((e,[t,n])=>Object.assign(Object.assign({},e),{[t]:n})),{}),d=yield t.createDoc(a.class.FSM,r().space.Model,Object.assign(Object.assign({},l(o)),{isTemplate:!1})),u=yield Promise.all(c.map((e=>f(void 0,void 0,void 0,(function*(){return[e,yield t.createDoc(a.class.State,r().space.Model,Object.assign(Object.assign({},l(e)),{fsm:d._id}))]}))))).then((e=>new Map(e.map((([e,t])=>[e._id,t._id])))));return yield Promise.all(s.map((e=>f(void 0,void 0,void 0,(function*(){var n,i;return yield t.createDoc(a.class.Transition,r().space.Model,Object.assign(Object.assign({},l(e)),{fsm:d._id,from:null!==(n=u.get(e.from))&&void 0!==n?n:"",to:null!==(i=u.get(e.to))&&void 0!==i?i:""}))}))))),d}))}}))}}]);