(self.webpackChunkprod=self.webpackChunkprod||[]).push([[81],{7715:function(t,e,i){t.exports=function(){"use strict";var t=Function.prototype.toString,e=Object.create,n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,a=Object.getPrototypeOf,c=Object.prototype,l=c.hasOwnProperty,u=c.propertyIsEnumerable,d="function"==typeof s,f="function"==typeof WeakMap,h=function(i,n){if(!i.constructor)return e(null);var o=i.constructor,r=i.__proto__||a(i);if(o===n.Object)return r===n.Object.prototype?{}:e(r);if(~t.call(o).indexOf("[native code]"))try{return new o}catch(t){}return e(r)},p=function(t,e,i,n){var o=h(t,e);for(var r in n.set(t,o),t)l.call(t,r)&&(o[r]=i(t[r],n));if(d){var a=s(t),c=a.length;if(c)for(var f=0,p=void 0;f<c;f++)p=a[f],u.call(t,p)&&(o[p]=i(t[p],n))}return o},v=function(t,e,i,a){var c=h(t,e);a.set(t,c);var l=d?r(t).concat(s(t)):r(t),u=l.length;if(u)for(var f=0,p=void 0,v=void 0;f<u;f++)if("callee"!==(p=l[f])&&"caller"!==p)if(v=o(t,p)){v.get||v.set||(v.value=i(t[p],a));try{n(c,p,v)}catch(t){c[p]=v.value}}else c[p]=i(t[p],a);return c},y=Array.isArray,b="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==i.g?i.g:void(console&&console.error&&console.error('Unable to locate global object, returning "this".'));function g(t,i){var n=!(!i||!i.isStrict),o=i&&i.realm||b,r=n?v:p,s=function(t,e){if(!t||"object"!=typeof t)return t;if(e.has(t))return e.get(t);var i,a,c,l=t.constructor;if(l===o.Object)return r(t,o,s,e);if(y(t)){if(n)return v(t,o,s,e);var u=t.length;i=new l,e.set(t,i);for(var d=0;d<u;d++)i[d]=s(t[d],e);return i}if(t instanceof o.Date)return new l(t.getTime());if(t instanceof o.RegExp)return(i=new l(t.source,t.flags||(a=t,c="",a.global&&(c+="g"),a.ignoreCase&&(c+="i"),a.multiline&&(c+="m"),a.unicode&&(c+="u"),a.sticky&&(c+="y"),c))).lastIndex=t.lastIndex,i;if(o.Map&&t instanceof o.Map)return i=new l,e.set(t,i),t.forEach((function(t,n){i.set(n,s(t,e))})),i;if(o.Set&&t instanceof o.Set)return i=new l,e.set(t,i),t.forEach((function(t){i.add(s(t,e))})),i;if(o.Blob&&t instanceof o.Blob)return t.slice(0,t.size,t.type);if(o.Buffer&&o.Buffer.isBuffer(t))return i=o.Buffer.allocUnsafe?o.Buffer.allocUnsafe(t.length):new l(t.length),e.set(t,i),t.copy(i),i;if(o.ArrayBuffer){if(o.ArrayBuffer.isView(t))return i=new l(t.buffer.slice(0)),e.set(t,i),i;if(t instanceof o.ArrayBuffer)return i=t.slice(0),e.set(t,i),i}return"function"==typeof t.then||t instanceof Error||o.WeakMap&&t instanceof o.WeakMap||o.WeakSet&&t instanceof o.WeakSet?t:r(t,o,s,e)};return s(t,function(){if(f)return new WeakMap;var t=e({has:function(e){return!!~t._keys.indexOf(e)},set:function(e,i){t._keys.push(e),t._values.push(i)},get:function(e){return t._values[t._keys.indexOf(e)]}});return t._keys=[],t._values=[],t}())}return g.default=g,g.strict=function(t,e){return g(t,{isStrict:!0,realm:e?e.realm:void 0})},g}()},5407:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{c(n.next(t))}catch(t){r(t)}}function a(t){try{c(n.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.NotificationClient=void 0;const o=i(9479),r=i(7715);e.NotificationClient=class{constructor(t){this.client=t,this.lastPosition=0,this.lastTime=0,this.waitingUpdate=!1,this.autoscroll=!1}before(t,e,i,o){return n(this,void 0,void 0,(function*(){i!==this.prevId?(this.waitingUpdate&&void 0!==this.prevId&&null!=this.prevNotifications&&(yield this.updateLastRead(e,o?this.prevId:void 0)),this.prevId=i,this.prevNotifications=r.default(e),this.lastPosition=0,this.lastTime=0,this.autoscroll=!1):this.lastPosition=t.scrollTop}))}readNow(t,e){return n(this,void 0,void 0,(function*(){this.lastTime=Date.now(),yield this.updateLastRead(t,e)}))}initScroll(t,e,i){if(this.autoscroll)t.scrollTo(0,t.scrollHeight);else if(this.lastPosition>0)t.scrollTo(0,this.lastPosition);else{if(e>0){const n=t.getElementsByClassName("message");let o;for(let t=i?1:0;t<n.length;t++){const i=n[t];if(void 0===i)continue;const r=i.dataset.lastmodified;if(void 0!==r&&parseInt(r)>e){o=i;break}}if(void 0!==o)return void o.scrollIntoView(!1)}t.scrollTo(0,t.scrollHeight)}}scrollHandler(t,e,i,o,r){if(void 0===e)return;this.lastPosition=t.scrollTop;const s=t.getElementsByClassName("message"),a=t.getBoundingClientRect().bottom;for(let t=o?1:0;t<s.length;t++){const e=s[t];if(e.getBoundingClientRect().bottom>a)break;const i=e.dataset.modified;if(void 0===i)continue;const n=parseInt(i);this.lastTime=n>this.lastTime?n:this.lastTime}this.lastTime>i&&(this.waitingUpdate||(this.waitingUpdate=!0,setTimeout((()=>n(this,void 0,void 0,(function*(){return yield this.updateLastRead(e,r)}))),3e3)))}setAutoscroll(t){this.autoscroll=this.lastPosition>0&&this.lastPosition>t.scrollHeight-t.clientHeight-30}updateLastRead(t,e){return n(this,void 0,void 0,(function*(){void 0!==t&&(void 0===e?yield this.client.updateDoc(t._class,t.space,t._id,{lastRead:this.lastTime}):(void 0===t.objectLastReads.set&&(t.objectLastReads=new Map),t.objectLastReads.set(e,this.lastTime),yield this.client.updateDoc(t._class,t.space,t._id,{objectLastReads:t.objectLastReads})),this.waitingUpdate=!1)}))}},e.default=o.plugin("notification",{},{class:{SpaceNotifications:"",SpaceInfo:""},mappers:{SpaceInfo:"",SpaceNotification:""},dd:{SpaceInfo:"",SpaceNotifications:""}})},4003:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{c(n.next(t))}catch(t){r(t)}}function a(t){try{c(n.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.PresentationClient=void 0;const o=i(9479),r=i(2451),s=i(9862);class a{constructor(t,e){this.client=t,this.callback=e,s.onDestroy((()=>{var t;null===(t=this.unsubscribe)||void 0===t||t.call(this),this.unsubscribe=void 0}))}update(t,e,i){var n;this.checkParams(e,t,i)||(null===(n=this.unsubscribe)||void 0===n||n.call(this),this.oldQuery=e,this.oldClass=t,this.oldOptions=i,this.client().then((n=>{this.unsubscribe=n.query(t,e,this.callback,i)})).catch((t=>{console.error(t)})))}checkParams(t,e,i){return r.deepEqual(this.oldQuery,t)&&this.oldClass===e&&r.deepEqual(this.oldOptions,i)}}class c{constructor(t,e){this.client=t,this.accountIdValue=e}static create(t,e){return n(this,void 0,void 0,(function*(){return new c(e,t)}))}findAll(t,e,i){return n(this,void 0,void 0,(function*(){return yield(yield this.client()).findAll(t,e,i)}))}tx(t){return n(this,void 0,void 0,(function*(){return yield(yield this.client()).tx(t).catch((t=>this.handleError(t)))}))}notifyTx(t){return n(this,void 0,void 0,(function*(){return yield(yield this.client()).notifyTx(t).catch((t=>this.handleError(t)))}))}query(t,e,i,n,o){return void 0!==t?(t.update(e,i,o),t):this.liveQuery(e,i,n,o)}accountId(){return this.accountIdValue}createDoc(t,e,i,o,r){return n(this,void 0,void 0,(function*(){return yield(yield this.client()).createDoc(t,e,i,o,r).catch((t=>{throw this.handleError(t),t}))}))}createShortRef(t,e,i){return n(this,void 0,void 0,(function*(){return yield(yield this.client()).createShortRef(t,e,i)}))}updateDoc(t,e,i,o,r){return n(this,void 0,void 0,(function*(){return yield(yield this.client()).updateDoc(t,e,i,o,r).catch((t=>this.handleError(t)))}))}removeDoc(t,e,i,o){return n(this,void 0,void 0,(function*(){return yield(yield this.client()).removeDoc(t,e,i,o).catch((t=>this.handleError(t)))}))}liveQuery(t,e,i,n){const o=new a(this.client,i);return o.update(t,e,n),{update:(t,e,i)=>o.update(t,e,i),unsubscribe:()=>{var t;null===(t=o.unsubscribe)||void 0===t||t.call(o)}}}handleError(t){throw console.error(t),t}}e.PresentationClient=c,e.default=o.plugin("presentation",{},{})}}]);